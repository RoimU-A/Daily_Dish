# Daily Dish アプリケーション企画書（v2）

## 1. プロジェクト概要

### 1.1 プロジェクト名
Daily Dish - 日々の料理生活を支える食材購入サポートアプリケーション

### 1.2 目的
家庭料理におけるレシピ管理と、ネットスーパーでの食材購入を自動化することで、ユーザーの日常的な料理生活を支援する。

### 1.3 プロジェクト背景
- 忙しい現代人にとって、食材購入の効率化は重要な課題
- 既存のレシピアプリと食材購入の分離により、ユーザー体験が断片化
- レシピから食材リストを自動生成し、購入までを一元化するニーズ

## 2. ターゲット

### 2.1 ターゲットユーザー
- **メインターゲット**: 家庭料理レベルの初心者
- **利用場面**: 日常的に料理をする個人
- **ニーズ**: レシピ管理と食材購入の効率化

### 2.2 ユーザー特性
- 料理レベル: 初心者〜中級者
- 年齢層: 20〜50代
- 利用デバイス: スマートフォン、タブレット、PC

## 3. 機能概要

### 3.1 主要機能

#### 機能1: レシピ管理機能
- **目的**: 料理レシピの登録・管理
- **機能詳細**: 
  - 既存レシピ（URL参照）の登録
  - 新規レシピ（独自レシピ）の詳細登録
  - 料理履歴の管理

#### 機能2: レシピからネットスーパーのカートへ食材を追加
- **対象サービス**: イオンネットスーパー
- **処理方法**: スクレイピング技術を使用
- **選択基準**: 価格が安い商品を優先
- **確認プロセス**: ユーザー確認必須

### 3.2 レシピデータ入力方式

#### 🔄 **変更点**: 一元化されたレシピ管理
- **変更前**: 既存レシピと新規レシピを別テーブルで管理
- **変更後**: 全てのレシピを`recipes`テーブルで一元管理

#### 統一されたレシピ登録
- **入力**: レシピ名、材料情報、URL（オプション）
- **処理**: 外部アプリケーションでURL→テキスト変換（既存レシピの場合）
- **本アプリ**: 全レシピ情報を`recipes`テーブルに登録
- **URL管理**: 
  - 既存レシピ: URLフィールドにレシピサイトURL
  - 新規レシピ: URLフィールドはNULL

## 4. 技術仕様

### 4.1 アプリケーション形態
- **基本形態**: Webアプリケーション
- **入力方法**: LineBot経由でのレシピ情報取得
- **デザイン**: レスポンシブデザイン対応

### 4.2 システム構成
- **フロントエンド**: Webアプリケーション
- **バックエンド**: データベース連携API
- **外部連携**: イオンネットスーパー（スクレイピング）
- **入力インターフェース**: LineBot

### 4.3 ユーザー管理
- **アカウント制**: 個人アカウント制（1アカウント1ユーザー）
- **拡張性**: 必要に応じて機能追加可能

## 5. 開発計画

### 5.1 段階的開発アプローチ

#### 第1段階: 基本レシピ管理機能
- **機能1**: テキスト情報のデータベース登録機能
- **機能2**: ユーザー新規レシピ登録機能
- **機能3**: データベースからのレシピ情報取得機能
- **機能4**: 料理履歴管理機能

#### 第2段階: 食材表示機能
- **機能5**: ユーザーの選択した食材を表示する機能
- **詳細**: 材料情報をキャッシュして管理、カート追加前の食材情報表示ページ

#### 第3段階: ネットスーパー連携機能
- **機能6**: イオンネットスーパーへのカート追加機能
- **技術**: スクレイピング技術を使用
- **処理**: ユーザー指定時に実行、実行後はキャッシュ削除

### 5.2 開発時検討事項
- **食材マッピング**: レシピ材料名とネットスーパー商品名の対応精度
- **スクレイピング**: 技術的安定性の確保

## 6. 期待効果

### 6.1 ユーザーメリット
- **効率化**: レシピ管理から食材購入まで一元化
- **時間短縮**: 食材購入の自動化による時間節約
- **経済効果**: 価格比較による食費削減
- **料理促進**: 手軽な食材調達による料理頻度向上

### 6.2 技術的価値
- **スクレイピング技術**: EC連携の技術実証
- **データ統合**: レシピと食材購入の統合管理
- **ユーザビリティ**: 直感的な操作性の実現

## 7. リスク分析

### 7.1 技術的リスク
- **スクレイピング**: サイト仕様変更による機能停止リスク
- **食材マッピング**: 商品名対応の精度課題
- **API制限**: 外部サービス利用制限

### 7.2 対応策
- **スクレイピング**: 定期的な監視とメンテナンス体制
- **マッピング**: 機械学習による精度向上の検討
- **外部連携**: 複数サービス対応による冗長性確保

## 8. 成功指標

### 8.1 定量指標
- **ユーザー数**: 月間アクティブユーザー数
- **利用頻度**: 週次利用率
- **機能利用率**: 各機能の使用率
- **データ精度**: 食材マッピング成功率

### 8.2 定性指標
- **ユーザー満足度**: アンケート調査結果
- **使いやすさ**: ユーザビリティテスト結果
- **継続利用**: リテンション率

## 9. 今後の展開

### 9.1 機能拡張
- **複数スーパー対応**: イオン以外のネットスーパー連携
- **AI機能**: レシピ推薦システム
- **SNS連携**: 料理記録の共有機能
- **栄養管理機能**: 将来的な健康管理機能追加

### 9.2 事業展開
- **パートナーシップ**: 食材宅配サービスとの連携
- **データ活用**: レシピデータの分析・提供サービス
- **マネタイズ**: プレミアム機能の追加

## 10. 削除された機能

### 10.1 栄養管理機能（削除理由）
- **当初計画**: レシピから栄養を管理する機能
- **削除理由**: 開発スコープの簡素化、コア機能への集中
- **将来対応**: 第4段階として将来的に追加検討可能

## 🆕 **11. v2での主要変更点**

### 11.1 データベース構造の変更
- **変更前**: `recipes`テーブル（新規のみ）+ `registered_recipes`テーブル（既存・新規管理）
- **変更後**: `recipes`テーブルのみでの一元管理
- **影響**: データ構造の簡素化、メンテナンス性向上

### 11.2 テーブル設計変更
#### recipes テーブル
- **追加フィールド**: `recipe_url`（VARCHAR(500), NULL可）
- **用途**: 既存レシピの場合はレシピサイトURL、新規レシピの場合はNULL

#### registered_recipes テーブル
- **廃止**: 完全に削除
- **移行**: 機能は`recipes`テーブルに統合

#### cooked_dishes テーブル
- **変更**: 外部キー参照先を`registered_recipes`から`recipes`に変更
- **フィールド**: `registered_recipe_id` → `recipe_id`

### 11.3 API仕様変更
- **リクエスト**: 既存・新規レシピ区別の廃止、統一されたレシピ登録API
- **エンドポイント**: `/api/web/registered-recipes/` → `/api/web/recipes/`のみ使用
- **データ形式**: URLフィールドを含む統一された形式

### 11.4 機能への影響
- **レシピ管理**: より直感的な単一テーブル管理
- **料理履歴**: 直接レシピを参照するシンプルな構造
- **食材キャッシュ**: 変更なし（既存通り）

---

**v2企画承認後、データベース変更とプログラム修正に着手予定**